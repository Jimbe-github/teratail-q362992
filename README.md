https://teratail.com/questions/362992 のコードから推測・改造したものです。
kotlin のコードは java から変換して修正したものなので、kotlin としてはどこか変かもしれません。
