https://teratail.com/questions/362992 のコードから推測・改造したものです。
